<!DOCTYPE HTML>
<html lang="en" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Interactive REPL - The Rash Book - Shell Safety and Purification</title>


        <!-- Custom HTML head -->

        <meta name="description" content="A comprehensive guide to Rash: shell safety, purification, and linting">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rash Book - Shell Safety and Purification</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/paiml/bashrs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/paiml/bashrs/edit/main/book/src/getting-started/repl.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="interactive-repl"><a class="header" href="#interactive-repl">Interactive REPL</a></h1>
<p>The bashrs REPL (Read-Eval-Print Loop) provides an interactive environment for bash script analysis, transformation, and learning.</p>
<h2 id="starting-the-repl"><a class="header" href="#starting-the-repl">Starting the REPL</a></h2>
<pre><code class="language-bash">$ bashrs repl

bashrs REPL v6.19.0
Type 'quit' or 'exit' to exit, 'help' for commands
Current mode: normal - Execute bash commands directly
bashrs [normal]&gt;
</code></pre>
<h2 id="features"><a class="header" href="#features">Features</a></h2>
<ul>
<li>üéØ <strong>5 Interactive Modes</strong>: Switch between different analysis modes</li>
<li>‚å®Ô∏è <strong>Tab Completion</strong>: Auto-complete commands, modes, file paths, and bash constructs</li>
<li>üìù <strong>Multi-line Input</strong>: Natural support for loops, functions, and conditionals</li>
<li>üîç <strong>Parser Integration</strong>: Parse bash code and inspect AST</li>
<li>üßπ <strong>Purifier Integration</strong>: Transform bash to idempotent/deterministic code</li>
<li>üîé <strong>Linter Integration</strong>: Real-time diagnostics with severity levels</li>
<li>üìö <strong>Command History</strong>: Persistent history in <code>~/.bashrs_history</code></li>
</ul>
<h2 id="available-commands"><a class="header" href="#available-commands">Available Commands</a></h2>
<h3 id="core-commands"><a class="header" href="#core-commands">Core Commands</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>help</code></td><td>Show all available commands</td></tr>
<tr><td><code>quit</code> or <code>exit</code></td><td>Exit the REPL</td></tr>
<tr><td><code>:mode</code></td><td>Show current mode and available modes</td></tr>
<tr><td><code>:mode &lt;name&gt;</code></td><td>Switch to a different mode</td></tr>
<tr><td><code>:parse &lt;code&gt;</code></td><td>Parse bash code and show AST</td></tr>
<tr><td><code>:purify &lt;code&gt;</code></td><td>Purify bash code (idempotent/deterministic)</td></tr>
<tr><td><code>:lint &lt;code&gt;</code></td><td>Lint bash code and show diagnostics</td></tr>
</tbody></table>
</div>
<h3 id="utility-commands"><a class="header" href="#utility-commands">Utility Commands</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>:history</code></td><td>Show command history for this session</td></tr>
<tr><td><code>:vars</code></td><td>Show session variables</td></tr>
<tr><td><code>:clear</code></td><td>Clear the screen</td></tr>
</tbody></table>
</div>
<h3 id="script-loading-commands"><a class="header" href="#script-loading-commands">Script Loading Commands</a></h3>
<p><strong>NEW in v6.20.0</strong>: Load bash scripts from files, extract functions, and manage your interactive development workflow.</p>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>:load &lt;file&gt;</code></td><td>Load a bash script and extract functions</td></tr>
<tr><td><code>:source &lt;file&gt;</code></td><td>Source a bash script (load and add to session)</td></tr>
<tr><td><code>:functions</code></td><td>List all loaded functions</td></tr>
<tr><td><code>:reload</code></td><td>Reload the last loaded script</td></tr>
</tbody></table>
</div>
<h3 id="mode-switching"><a class="header" href="#mode-switching">Mode Switching</a></h3>
<p>The REPL supports 5 interactive modes:</p>
<pre><code class="language-bash">bashrs [normal]&gt; :mode
Current mode: normal - Execute bash commands directly

Available modes:
  normal  - Execute bash commands directly
  purify  - Show purified version of bash commands
  lint    - Show linting results for bash commands
  debug   - Debug bash commands with step-by-step execution
  explain - Explain bash constructs and syntax

Usage: :mode &lt;mode_name&gt;
</code></pre>
<p>Switch modes with <code>:mode &lt;name&gt;</code>:</p>
<pre><code class="language-bash">bashrs [normal]&gt; :mode lint
Switched to lint mode - Show linting results for bash commands
bashrs [lint]&gt;
</code></pre>
<h3 id="automatic-mode-based-processing"><a class="header" href="#automatic-mode-based-processing">Automatic Mode-Based Processing</a></h3>
<p><strong>NEW in v6.19.0</strong>: When you switch to <code>purify</code> or <code>lint</code> mode, commands are automatically processed in that mode without needing explicit <code>:purify</code> or <code>:lint</code> prefixes.</p>
<h4 id="purify-mode"><a class="header" href="#purify-mode">Purify Mode</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; :mode purify
Switched to purify mode

<span class="boring"> Commands are automatically purified
</span>bashrs [purify]&gt; mkdir /tmp/test
‚úì Purified:
Purified 1 statement(s)
(Full bash output coming soon)

bashrs [purify]&gt; rm /old/file
‚úì Purified:
Purified 1 statement(s)
</code></pre>
<h4 id="lint-mode"><a class="header" href="#lint-mode">Lint Mode</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; :mode lint
Switched to lint mode

<span class="boring"> Commands are automatically linted
</span>bashrs [lint]&gt; cat file.txt | grep pattern
Found 1 issue(s):
  ‚ö† 1 warning(s)

[1] ‚ö† SC2086 - Useless cat
</code></pre>
<h4 id="explicit-commands-still-work"><a class="header" href="#explicit-commands-still-work">Explicit Commands Still Work</a></h4>
<p>Explicit commands (<code>:parse</code>, <code>:purify</code>, <code>:lint</code>) work in <strong>any mode</strong>:</p>
<pre><code class="language-bash">bashrs [purify]&gt; :parse echo hello
‚úì Parse successful!
Statements: 1

bashrs [lint]&gt; :purify mkdir test
‚úì Purification successful!
Purified 1 statement(s)
</code></pre>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<h3 id="example-1-parsing-bash-code"><a class="header" href="#example-1-parsing-bash-code">Example 1: Parsing Bash Code</a></h3>
<pre><code class="language-bash">bashrs [normal]&gt; :parse echo hello world
‚úì Parse successful!
Statements: 1
Parse time: 0ms

AST:
  [0] SimpleCommand {
    name: "echo",
    args: ["hello", "world"]
  }
</code></pre>
<h3 id="example-2-purifying-non-idempotent-code"><a class="header" href="#example-2-purifying-non-idempotent-code">Example 2: Purifying Non-Idempotent Code</a></h3>
<pre><code class="language-bash">bashrs [normal]&gt; :purify mkdir /tmp/myapp
‚úì Purification successful!
Purified 1 statements

Original:
  mkdir /tmp/myapp

Purified:
  mkdir -p "/tmp/myapp"  # Idempotent + quoted
</code></pre>
<h3 id="example-3-linting-for-safety-issues"><a class="header" href="#example-3-linting-for-safety-issues">Example 3: Linting for Safety Issues</a></h3>
<pre><code class="language-bash">bashrs [normal]&gt; :lint cat file.txt | grep $PATTERN
Found 1 issue(s):
  ‚ö† 1 warning(s)

[1] ‚ö† SC2086 - Double quote to prevent globbing and word splitting
    Line 1
    Variable: PATTERN

Fix: cat file.txt | grep "$PATTERN"
</code></pre>
<h3 id="example-4-mode-based-workflow"><a class="header" href="#example-4-mode-based-workflow">Example 4: Mode-Based Workflow</a></h3>
<pre><code class="language-bash"><span class="boring"> Start in normal mode
</span>bashrs [normal]&gt; :parse if [ -f config.txt ]; then cat config.txt; fi
‚úì Parse successful!

<span class="boring"> Switch to lint mode
</span>bashrs [normal]&gt; :mode lint
Switched to lint mode

<span class="boring"> Lint the code
</span>bashrs [lint]&gt; :lint if [ -f config.txt ]; then cat config.txt; fi
‚úì No issues found!

<span class="boring"> Switch to purify mode
</span>bashrs [lint]&gt; :mode purify
Switched to purify mode

<span class="boring"> See the purified version
</span>bashrs [purify]&gt; :purify mkdir /var/log/app
‚úì Purification successful!
Purified: mkdir -p "/var/log/app"
</code></pre>
<h3 id="example-5-using-utility-commands"><a class="header" href="#example-5-using-utility-commands">Example 5: Using Utility Commands</a></h3>
<p><strong>NEW in v6.19.0</strong>: The REPL now includes utility commands for managing your session.</p>
<h4 id="view-command-history"><a class="header" href="#view-command-history">View Command History</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; echo hello
Would execute: echo hello

bashrs [normal]&gt; mkdir test
Would execute: mkdir test

bashrs [normal]&gt; :history
Command History (3 commands):
  1 echo hello
  2 mkdir test
  3 :history
</code></pre>
<h4 id="view-session-variables"><a class="header" href="#view-session-variables">View Session Variables</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; :vars
No session variables set

<span class="boring"> After assigning variables
</span>bashrs [normal]&gt; x=5
‚úì Variable set: x = 5

bashrs [normal]&gt; name="Alice"
‚úì Variable set: name = Alice

bashrs [normal]&gt; :vars
Session Variables (2 variables):
  name = Alice
  x = 5
</code></pre>
<h4 id="clear-screen"><a class="header" href="#clear-screen">Clear Screen</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; echo "lots of output..."
bashrs [normal]&gt; echo "more output..."
bashrs [normal]&gt; :clear
<span class="boring"> Screen cleared, fresh prompt
</span>bashrs [normal]&gt;
</code></pre>
<h3 id="example-6-automatic-mode-processing-workflow"><a class="header" href="#example-6-automatic-mode-processing-workflow">Example 6: Automatic Mode Processing Workflow</a></h3>
<p><strong>NEW in v6.19.0</strong>: The killer feature - automatic command processing in purify/lint modes.</p>
<pre><code class="language-bash"><span class="boring"> Switch to purify mode
</span>bashrs [normal]&gt; :mode purify
Switched to purify mode

<span class="boring"> Commands are AUTOMATICALLY purified
</span>bashrs [purify]&gt; mkdir /tmp/test
‚úì Purified:
Purified 1 statement(s)

bashrs [purify]&gt; rm /tmp/old
‚úì Purified:
Purified 1 statement(s)

<span class="boring"> Switch to lint mode
</span>bashrs [purify]&gt; :mode lint
Switched to lint mode

<span class="boring"> Commands are AUTOMATICALLY linted
</span>bashrs [lint]&gt; cat file | grep pattern
Found 1 issue(s):
  ‚ö† 1 warning(s)

<span class="boring"> View what you've done
</span>bashrs [lint]&gt; :history
Command History (6 commands):
  1 :mode purify
  2 mkdir /tmp/test
  3 rm /tmp/old
  4 :mode lint
  5 cat file | grep pattern
  6 :history
</code></pre>
<h3 id="example-7-using-explain-mode-for-learning-bash"><a class="header" href="#example-7-using-explain-mode-for-learning-bash">Example 7: Using Explain Mode for Learning Bash</a></h3>
<p><strong>NEW in v6.19.0</strong>: The Explain Mode provides interactive explanations of bash constructs to help you learn shell scripting.</p>
<h4 id="switch-to-explain-mode"><a class="header" href="#switch-to-explain-mode">Switch to Explain Mode</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; :mode explain
Switched to explain mode - Explain bash constructs and syntax
bashrs [explain]&gt;
</code></pre>
<h4 id="explain-parameter-expansions"><a class="header" href="#explain-parameter-expansions">Explain Parameter Expansions</a></h4>
<pre><code class="language-bash">bashrs [explain]&gt; ${var:-default}
üìñ Parameter Expansion: ${parameter:-word}
   Use Default Value

If parameter is unset or null, expand to 'word'.
The original parameter remains unchanged.

Example:
  $ var=""
  $ echo "${var:-fallback}"  # Outputs: fallback
  $ echo "$var"               # Still empty

bashrs [explain]&gt; ${var:=default}
üìñ Parameter Expansion: ${parameter:=word}
   Assign Default Value

If parameter is unset or null, assign 'word' to it.
Then expand to the new value.

Example:
  $ unset var
  $ echo "${var:=fallback}"  # Outputs: fallback
  $ echo "$var"               # Now set to fallback

bashrs [explain]&gt; ${#var}
üìñ Parameter Expansion: ${#parameter}
   String Length

Expands to the length of the parameter's value in characters.

Example:
  $ var="hello"
  $ echo "${#var}"  # Outputs: 5
</code></pre>
<h4 id="explain-control-flow-constructs"><a class="header" href="#explain-control-flow-constructs">Explain Control Flow Constructs</a></h4>
<pre><code class="language-bash">bashrs [explain]&gt; for i in *.txt
üìñ For Loop: for name in words
   Iterate Over List

Loop variable 'name' takes each value from the word list.
Executes commands for each iteration.

Example:
  for file in *.txt; do
    echo "Processing: $file"
  done

bashrs [explain]&gt; if [ -f file ]
üìñ If Statement: if condition; then commands; fi
   Conditional Execution

Execute commands only if condition succeeds (exit status 0).
Optional elif and else clauses for alternatives.

Example:
  if [ -f file.txt ]; then
    echo "File exists"
  fi

bashrs [explain]&gt; while true
üìñ While Loop: while condition; do commands; done
   Conditional Loop

Execute commands repeatedly while condition succeeds.
Checks condition before each iteration.

Example:
  counter=0
  while [ $counter -lt 5 ]; do
    echo $counter
    counter=$((counter + 1))
  done
</code></pre>
<h4 id="explain-io-redirection"><a class="header" href="#explain-io-redirection">Explain I/O Redirection</a></h4>
<pre><code class="language-bash">bashrs [explain]&gt; echo test &gt; file
üìñ Output Redirection: command &gt; file
   Redirect Standard Output

Redirects stdout to a file, overwriting existing content.
Use &gt;&gt; to append instead.

Example:
  echo "text" &gt; file.txt   # Overwrite
  echo "more" &gt;&gt; file.txt  # Append

bashrs [explain]&gt; cat &lt; file
üìñ Input Redirection: command &lt; file
   Redirect Standard Input

Redirects stdin to read from a file instead of keyboard.

Example:
  while read line; do
    echo "Line: $line"
  done &lt; file.txt

bashrs [explain]&gt; cat file | grep pattern
üìñ Pipe: command1 | command2
   Connect Commands

Redirects stdout of command1 to stdin of command2.
Enables chaining multiple commands together.

Example:
  cat file.txt | grep pattern | wc -l
</code></pre>
<h4 id="unknown-constructs"><a class="header" href="#unknown-constructs">Unknown Constructs</a></h4>
<pre><code class="language-bash">bashrs [explain]&gt; unknown_command_xyz
No explanation available for: unknown_command_xyz
Try parameter expansions (${var:-default}), control flow (for, if, while), or redirections (&gt;, &lt;, |)
</code></pre>
<h4 id="combining-explain-mode-with-other-commands"><a class="header" href="#combining-explain-mode-with-other-commands">Combining Explain Mode with Other Commands</a></h4>
<pre><code class="language-bash"><span class="boring"> Explain a construct, then lint it
</span>bashrs [explain]&gt; ${var:-default}
üìñ Parameter Expansion: ${parameter:-word}
   Use Default Value
...

bashrs [explain]&gt; :lint echo ${var:-default}
‚úì No issues found!

<span class="boring"> Switch to purify mode to see transformations
</span>bashrs [explain]&gt; :mode purify
Switched to purify mode

bashrs [purify]&gt; mkdir /tmp/test
‚úì Purified:
Purified 1 statement(s)
</code></pre>
<h3 id="example-8-variable-assignment-and-expansion"><a class="header" href="#example-8-variable-assignment-and-expansion">Example 8: Variable Assignment and Expansion</a></h3>
<p><strong>NEW in v6.20.0</strong>: The REPL now supports bash-style variable assignment and automatic expansion in commands.</p>
<p><strong>NEW in v6.21.0</strong>: Normal mode now executes commands directly with full bash compatibility.</p>
<h4 id="simple-variable-assignment"><a class="header" href="#simple-variable-assignment">Simple Variable Assignment</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; x=5
‚úì Variable set: x = 5

bashrs [normal]&gt; echo $x
5
</code></pre>
<h4 id="variable-assignment-with-quotes"><a class="header" href="#variable-assignment-with-quotes">Variable Assignment with Quotes</a></h4>
<pre><code class="language-bash"><span class="boring"> Double quotes
</span>bashrs [normal]&gt; name="Alice Johnson"
‚úì Variable set: name = Alice Johnson

<span class="boring"> Single quotes
</span>bashrs [normal]&gt; path='/usr/local/bin'
‚úì Variable set: path = /usr/local/bin
</code></pre>
<h4 id="variable-expansion-syntax"><a class="header" href="#variable-expansion-syntax">Variable Expansion Syntax</a></h4>
<pre><code class="language-bash"><span class="boring"> Simple expansion
</span>bashrs [normal]&gt; version=1.0.0
‚úì Variable set: version = 1.0.0

bashrs [normal]&gt; echo $version
Would execute: echo 1.0.0

<span class="boring"> Braced expansion
</span>bashrs [normal]&gt; echo Release: ${version}
Would execute: echo Release: 1.0.0
</code></pre>
<h4 id="multiple-variables"><a class="header" href="#multiple-variables">Multiple Variables</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; x=10
‚úì Variable set: x = 10

bashrs [normal]&gt; y=20
‚úì Variable set: y = 20

bashrs [normal]&gt; echo $x + $y = 30
Would execute: echo 10 + 20 = 30

bashrs [normal]&gt; :vars
Session Variables (2 variables):
  x = 10
  y = 20
</code></pre>
<h4 id="variables-with-purify-mode"><a class="header" href="#variables-with-purify-mode">Variables with Purify Mode</a></h4>
<pre><code class="language-bash"><span class="boring"> Switch to purify mode
</span>bashrs [normal]&gt; :mode purify
Switched to purify mode

<span class="boring"> Assign variable
</span>bashrs [purify]&gt; dir=/tmp/myapp
‚úì Variable set: dir = /tmp/myapp

<span class="boring"> Variable is expanded before purification
</span>bashrs [purify]&gt; mkdir $dir
‚úì Purified:
Purified 1 statement(s)
</code></pre>
<h4 id="variables-with-lint-mode"><a class="header" href="#variables-with-lint-mode">Variables with Lint Mode</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; :mode lint
Switched to lint mode

bashrs [lint]&gt; filename=config.txt
‚úì Variable set: filename = config.txt

bashrs [lint]&gt; cat $filename | grep pattern
Found 1 issue(s):
  ‚ö† 1 warning(s)
</code></pre>
<h4 id="unknown-variables"><a class="header" href="#unknown-variables">Unknown Variables</a></h4>
<pre><code class="language-bash"><span class="boring"> Unknown variables expand to empty string (bash behavior)
</span>bashrs [normal]&gt; echo $unknown_var
Would execute: echo

bashrs [normal]&gt; echo Before:$missing:After
Would execute: echo Before::After
</code></pre>
<h4 id="variable-reassignment"><a class="header" href="#variable-reassignment">Variable Reassignment</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; status=pending
‚úì Variable set: status = pending

bashrs [normal]&gt; status=complete
‚úì Variable set: status = complete

bashrs [normal]&gt; echo $status
Would execute: echo complete
</code></pre>
<h4 id="viewing-variables"><a class="header" href="#viewing-variables">Viewing Variables</a></h4>
<pre><code class="language-bash"><span class="boring"> View all session variables
</span>bashrs [normal]&gt; user=alice
‚úì Variable set: user = alice

bashrs [normal]&gt; role=admin
‚úì Variable set: role = admin

bashrs [normal]&gt; :vars
Session Variables (2 variables):
  role = admin
  user = alice
</code></pre>
<p><strong>Notes</strong>:</p>
<ul>
<li>Variables persist throughout your REPL session</li>
<li>Variables persist across mode switches</li>
<li>Variable names must start with a letter or underscore</li>
<li>Variable names can contain letters, numbers, and underscores</li>
<li>Unknown variables expand to empty string (matching bash behavior)</li>
<li>Use <code>:vars</code> to view all session variables</li>
</ul>
<h3 id="example-9-script-loading-and-function-extraction"><a class="header" href="#example-9-script-loading-and-function-extraction">Example 9: Script Loading and Function Extraction</a></h3>
<p><strong>NEW in v6.20.0</strong>: Load bash scripts from files to inspect their structure, extract functions, and develop scripts interactively.</p>
<h4 id="loading-a-simple-script"><a class="header" href="#loading-a-simple-script">Loading a Simple Script</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; :load examples/hello.sh
‚úì Loaded: examples/hello.sh (no functions, 3 lines)
</code></pre>
<h4 id="loading-a-script-with-functions"><a class="header" href="#loading-a-script-with-functions">Loading a Script with Functions</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; :load examples/utils.sh
‚úì Loaded: examples/utils.sh (3 functions, 25 lines)
</code></pre>
<h4 id="viewing-loaded-functions"><a class="header" href="#viewing-loaded-functions">Viewing Loaded Functions</a></h4>
<pre><code class="language-bash">bashrs [normal]&gt; :functions
Available functions (3 total):
  1 log_info
  2 log_error
  3 check_dependencies
</code></pre>
<h4 id="sourcing-a-script-load-and-execute"><a class="header" href="#sourcing-a-script-load-and-execute">Sourcing a Script (Load and Execute)</a></h4>
<pre><code class="language-bash"><span class="boring"> Source adds functions to your session
</span>bashrs [normal]&gt; :source examples/lib.sh
‚úì Sourced: examples/lib.sh (2 functions)

bashrs [normal]&gt; :functions
Available functions (2 total):
  1 greet
  2 farewell
</code></pre>
<h4 id="reloading-a-script-after-changes"><a class="header" href="#reloading-a-script-after-changes">Reloading a Script After Changes</a></h4>
<pre><code class="language-bash"><span class="boring"> Edit the script in another window...
</span><span class="boring"> Then reload it in the REPL
</span>bashrs [normal]&gt; :reload
Reloading: examples/utils.sh
‚úì Reloaded: examples/utils.sh (4 functions)

bashrs [normal]&gt; :functions
Available functions (4 total):
  1 log_info
  2 log_error
  3 log_warning
  4 check_dependencies
</code></pre>
<h4 id="script-loading-workflow"><a class="header" href="#script-loading-workflow">Script Loading Workflow</a></h4>
<pre><code class="language-bash"><span class="boring"> Step 1: Load a script to inspect it
</span>bashrs [normal]&gt; :load deploy.sh
‚úì Loaded: deploy.sh (5 functions, 120 lines)

<span class="boring"> Step 2: View extracted functions
</span>bashrs [normal]&gt; :functions
Available functions (5 total):
  1 validate_env
  2 build_app
  3 run_tests
  4 deploy_staging
  5 deploy_production

<span class="boring"> Step 3: Switch to lint mode to check quality
</span>bashrs [normal]&gt; :mode lint
Switched to lint mode

<span class="boring"> Step 4: Reload to check latest changes
</span>bashrs [lint]&gt; :reload
Reloading: deploy.sh
‚úì Reloaded: deploy.sh (5 functions, 125 lines)
</code></pre>
<h4 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h4>
<pre><code class="language-bash"><span class="boring"> Nonexistent file
</span>bashrs [normal]&gt; :load missing.sh
‚úó Error: Cannot read file missing.sh: No such file or directory

<span class="boring"> Invalid syntax
</span>bashrs [normal]&gt; :load broken.sh
‚úó Parse error: Parse error: unexpected token

<span class="boring"> No script to reload
</span>bashrs [normal]&gt; :reload
No script to reload. Use :load &lt;file&gt; first.
</code></pre>
<p><strong>Use Cases</strong>:</p>
<ul>
<li><strong>Interactive Development</strong>: Load your script while editing to see structure</li>
<li><strong>Function Exploration</strong>: Quickly see all functions in a complex script</li>
<li><strong>Live Reload</strong>: Edit script externally, use <code>:reload</code> to see changes</li>
<li><strong>Quality Workflow</strong>: Load ‚Üí Inspect ‚Üí Lint ‚Üí Purify ‚Üí Reload cycle</li>
<li><strong>Learning</strong>: Explore example scripts to understand bash patterns</li>
</ul>
<p><strong>Notes</strong>:</p>
<ul>
<li><code>:load</code> parses the script and extracts function names</li>
<li><code>:source</code> is similar to bash <code>source</code>/<code>.</code> command</li>
<li>Functions are tracked in REPL state across mode switches</li>
<li><code>:reload</code> reloads the most recently loaded script</li>
<li>Scripts must have valid bash syntax to load successfully</li>
<li>Use <code>:functions</code> to see all currently loaded functions</li>
</ul>
<h2 id="tab-completion"><a class="header" href="#tab-completion">Tab Completion</a></h2>
<p><strong>NEW in v6.20.0</strong>: The REPL now includes intelligent tab completion to speed up your workflow and reduce typing errors.</p>
<h3 id="command-completion"><a class="header" href="#command-completion">Command Completion</a></h3>
<p>Press <code>Tab</code> to auto-complete REPL commands:</p>
<pre><code class="language-bash">bashrs [normal]&gt; :mo&lt;TAB&gt;
<span class="boring"> Completes to: :mode
</span>
bashrs [normal]&gt; :p&lt;TAB&gt;
<span class="boring"> Shows: :parse  :purify
</span>
bashrs [normal]&gt; :h&lt;TAB&gt;
<span class="boring"> Completes to: :history
</span></code></pre>
<h3 id="mode-name-completion"><a class="header" href="#mode-name-completion">Mode Name Completion</a></h3>
<p>After typing <code>:mode</code>, press <code>Tab</code> to complete mode names:</p>
<pre><code class="language-bash">bashrs [normal]&gt; :mode pur&lt;TAB&gt;
<span class="boring"> Completes to: :mode purify
</span>
bashrs [normal]&gt; :mode &lt;TAB&gt;
<span class="boring"> Shows all modes: normal  purify  lint  debug  explain
</span></code></pre>
<h3 id="bash-construct-completion"><a class="header" href="#bash-construct-completion">Bash Construct Completion</a></h3>
<p>Tab completion also works for common bash constructs:</p>
<pre><code class="language-bash">bashrs [explain]&gt; for&lt;TAB&gt;
<span class="boring"> Completes to: for i in
</span>
bashrs [explain]&gt; ${var:&lt;TAB&gt;
<span class="boring"> Shows: ${var:-default}  ${var:=default}  ${var:?error}  ${var:+alternate}
</span></code></pre>
<h3 id="file-path-completion"><a class="header" href="#file-path-completion">File Path Completion</a></h3>
<p><strong>NEW in v6.20.0</strong>: Tab completion for file paths makes loading scripts effortless:</p>
<pre><code class="language-bash">bashrs [normal]&gt; :load ex&lt;TAB&gt;
<span class="boring"> Completes to: :load examples/
</span>
bashrs [normal]&gt; :load examples/te&lt;TAB&gt;
<span class="boring"> Completes to: :load examples/test.sh
</span>
bashrs [normal]&gt; :source script&lt;TAB&gt;
<span class="boring"> Shows all files starting with "script": script1.sh  script2.sh  script_utils.sh
</span></code></pre>
<p><strong>Features</strong>:</p>
<ul>
<li>Directories are shown with trailing <code>/</code> and listed first</li>
<li>Hidden files (starting with <code>.</code>) are excluded by default</li>
<li>File paths are completed relative to current directory</li>
<li>Works with both <code>:load</code> and <code>:source</code> commands</li>
</ul>
<h3 id="case-insensitive-completion"><a class="header" href="#case-insensitive-completion">Case-Insensitive Completion</a></h3>
<p>Tab completion is case-insensitive for convenience:</p>
<pre><code class="language-bash">bashrs [normal]&gt; :MO&lt;TAB&gt;
<span class="boring"> Completes to: :mode
</span>
bashrs [normal]&gt; :mode PUR&lt;TAB&gt;
<span class="boring"> Completes to: :mode purify
</span></code></pre>
<h3 id="completion-examples"><a class="header" href="#completion-examples">Completion Examples</a></h3>
<p><strong>Example 1: Quick mode switching</strong></p>
<pre><code class="language-bash">bashrs [normal]&gt; :m&lt;TAB&gt;pur&lt;TAB&gt;&lt;ENTER&gt;
<span class="boring"> Result: :mode purify
</span>Switched to purify mode
</code></pre>
<p><strong>Example 2: Exploring commands</strong></p>
<pre><code class="language-bash">bashrs [normal]&gt; :&lt;TAB&gt;
<span class="boring"> Shows all commands:
</span><span class="boring"> :clear  :functions  :history  :lint  :load  :mode  :parse  :purify  :reload  :source  :vars
</span></code></pre>
<p><strong>Example 3: Learning bash constructs</strong></p>
<pre><code class="language-bash">bashrs [explain]&gt; $&lt;TAB&gt;
<span class="boring"> Shows parameter expansions:
</span><span class="boring"> ${var:-default}  ${var:=default}  ${var:?error}  ${var:+alternate}  ${#var}
</span></code></pre>
<h2 id="multi-line-input"><a class="header" href="#multi-line-input">Multi-line Input</a></h2>
<p><strong>NEW in v6.20.0</strong>: The REPL now supports multi-line input for complex bash constructs like functions, loops, and conditionals.</p>
<p>When the REPL detects incomplete input, it automatically switches to continuation mode with a <code>... &gt;</code> prompt.</p>
<h3 id="functions"><a class="header" href="#functions">Functions</a></h3>
<pre><code class="language-bash">bashrs [normal]&gt; function greet() {
... &gt;   echo "Hello, $1"
... &gt;   echo "Welcome to bashrs"
... &gt; }
‚úì Function 'greet' defined

bashrs [normal]&gt; greet "Alice"
Hello, Alice
Welcome to bashrs
</code></pre>
<h3 id="for-loops"><a class="header" href="#for-loops">For Loops</a></h3>
<pre><code class="language-bash">bashrs [normal]&gt; for i in 1 2 3; do
... &gt;   echo "Iteration $i"
... &gt; done
Iteration 1
Iteration 2
Iteration 3
</code></pre>
<h3 id="if-statements"><a class="header" href="#if-statements">If Statements</a></h3>
<pre><code class="language-bash">bashrs [normal]&gt; if [ -f "/etc/passwd" ]; then
... &gt;   echo "File exists"
... &gt; fi
File exists
</code></pre>
<h3 id="while-loops"><a class="header" href="#while-loops">While Loops</a></h3>
<pre><code class="language-bash">bashrs [normal]&gt; count=0
‚úì Variable set: count = 0

bashrs [normal]&gt; while [ $count -lt 3 ]; do
... &gt;   echo "Count: $count"
... &gt;   count=$((count + 1))
... &gt; done
Count: 0
Count: 1
Count: 2
</code></pre>
<h3 id="case-statements"><a class="header" href="#case-statements">Case Statements</a></h3>
<pre><code class="language-bash">bashrs [normal]&gt; case "apple" in
... &gt;   apple) echo "It's an apple";;
... &gt;   banana) echo "It's a banana";;
... &gt;   *) echo "Unknown fruit";;
... &gt; esac
It's an apple
</code></pre>
<h3 id="cancelling-multi-line-input"><a class="header" href="#cancelling-multi-line-input">Cancelling Multi-line Input</a></h3>
<p>Press <code>Ctrl-C</code> to cancel multi-line input and return to the main prompt:</p>
<pre><code class="language-bash">bashrs [normal]&gt; for i in 1 2 3; do
... &gt;   echo "This is a loop"
... &gt; ^C (multi-line input cancelled)
bashrs [normal]&gt;
</code></pre>
<h3 id="automatic-detection"><a class="header" href="#automatic-detection">Automatic Detection</a></h3>
<p>The REPL intelligently detects when input is incomplete by checking for:</p>
<ul>
<li>Unclosed quotes (single or double)</li>
<li>Unclosed braces, parentheses, or brackets</li>
<li>Bash keywords expecting continuation (<code>if</code>, <code>for</code>, <code>while</code>, <code>function</code>, <code>case</code>)</li>
<li>Line ending with backslash (<code>\</code>)</li>
</ul>
<p>This allows natural, interactive development of complex bash scripts within the REPL.</p>
<h2 id="command-history"><a class="header" href="#command-history">Command History</a></h2>
<p>The REPL automatically saves command history to <code>~/.bashrs_history</code>:</p>
<pre><code class="language-bash"><span class="boring"> Commands are saved across sessions
</span>$ bashrs repl
bashrs [normal]&gt; :parse echo test
...
bashrs [normal]&gt; quit
Goodbye!

<span class="boring"> Later...
</span>$ bashrs repl
bashrs [normal]&gt; # Press ‚Üë to recall previous commands
</code></pre>
<h3 id="history-navigation"><a class="header" href="#history-navigation">History Navigation</a></h3>
<ul>
<li><strong>‚Üë (Up Arrow)</strong>: Previous command</li>
<li><strong>‚Üì (Down Arrow)</strong>: Next command</li>
<li><strong>Ctrl-R</strong>: Reverse search through history</li>
<li><strong>Tab</strong>: Auto-complete commands, modes, and bash constructs</li>
<li><strong>Ctrl-C</strong>: Cancel current line</li>
<li><strong>Ctrl-D</strong>: Exit REPL (EOF)</li>
</ul>
<h2 id="repl-configuration"><a class="header" href="#repl-configuration">REPL Configuration</a></h2>
<p>Configure REPL behavior with command-line flags:</p>
<pre><code class="language-bash"><span class="boring"> Enable debug mode
</span>$ bashrs repl --debug

<span class="boring"> Set resource limits
</span>$ bashrs repl --max-memory 200 --timeout 60

<span class="boring"> Sandboxed mode (restricted operations)
</span>$ bashrs repl --sandboxed
</code></pre>
<h3 id="available-options"><a class="header" href="#available-options">Available Options</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Option</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr><td><code>--debug</code></td><td>false</td><td>Enable debug mode</td></tr>
<tr><td><code>--max-memory</code></td><td>500MB</td><td>Maximum memory usage</td></tr>
<tr><td><code>--timeout</code></td><td>120s</td><td>Command timeout</td></tr>
<tr><td><code>--max-depth</code></td><td>1000</td><td>Maximum recursion depth</td></tr>
<tr><td><code>--sandboxed</code></td><td>false</td><td>Run in sandboxed mode</td></tr>
</tbody></table>
</div>
<h2 id="use-cases"><a class="header" href="#use-cases">Use Cases</a></h2>
<h3 id="learning-bash"><a class="header" href="#learning-bash">Learning Bash</a></h3>
<p>Use the REPL to interactively learn bash constructs and transformations:</p>
<pre><code class="language-bash"><span class="boring"> Learn about parameter expansions
</span>bashrs [normal]&gt; :mode explain
Switched to explain mode

bashrs [explain]&gt; ${var:-default}
üìñ Parameter Expansion: ${parameter:-word}
   Use Default Value
...

<span class="boring"> Learn about control flow
</span>bashrs [explain]&gt; for i in *.txt
üìñ For Loop: for name in words
   Iterate Over List
...

<span class="boring"> Switch to purify mode to see transformations
</span>bashrs [explain]&gt; :mode purify
Switched to purify mode

bashrs [purify]&gt; rm -rf /tmp/data
‚úì Purified:
Purified 1 statement(s)
</code></pre>
<h3 id="quick-validation"><a class="header" href="#quick-validation">Quick Validation</a></h3>
<p>Validate bash snippets before committing:</p>
<pre><code class="language-bash">$ bashrs repl
bashrs [normal]&gt; :lint $(cat deploy.sh)
Found 3 issue(s):
  ‚ö† 2 warning(s)
  ‚Ñπ 1 info

<span class="boring"> Fix issues...
</span>
bashrs [normal]&gt; :lint $(cat deploy.sh)
‚úì No issues found!
</code></pre>
<h3 id="experimenting-with-transformations"><a class="header" href="#experimenting-with-transformations">Experimenting with Transformations</a></h3>
<p>Test purification transformations interactively:</p>
<pre><code class="language-bash">bashrs [normal]&gt; :purify SESSION_ID=$RANDOM
‚úì Purified: SESSION_ID="$(date +%s)-$$"  # Deterministic

bashrs [normal]&gt; :purify RELEASE="release-$(date +%s)"
‚úì Purified: RELEASE="release-${VERSION}"  # Version-based
</code></pre>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="repl-wont-start"><a class="header" href="#repl-wont-start">REPL Won't Start</a></h3>
<p><strong>Error</strong>: <code>Failed to initialize REPL</code></p>
<p><strong>Solution</strong>: Check that your terminal supports ANSI escape codes:</p>
<pre><code class="language-bash"><span class="boring"> Test terminal support
</span>$ echo -e "\e[1mBold\e[0m"

<span class="boring"> If that doesn't work, use a different terminal
</span></code></pre>
<h3 id="history-not-persisting"><a class="header" href="#history-not-persisting">History Not Persisting</a></h3>
<p><strong>Error</strong>: Commands not saved across sessions</p>
<p><strong>Solution</strong>: Check history file permissions:</p>
<pre><code class="language-bash">$ ls -la ~/.bashrs_history
<span class="boring"> Should be readable/writable by your user
</span>
<span class="boring"> Fix permissions if needed
</span>$ chmod 600 ~/.bashrs_history
</code></pre>
<h3 id="out-of-memory"><a class="header" href="#out-of-memory">Out of Memory</a></h3>
<p><strong>Error</strong>: <code>REPL out of memory</code></p>
<p><strong>Solution</strong>: Increase memory limit:</p>
<pre><code class="language-bash">$ bashrs repl --max-memory 1000  # 1GB
</code></pre>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<ul>
<li><a href="../reference/repl-commands.html">REPL Commands Reference</a> - Complete command reference</li>
<li><a href="../concepts/purification.html">Purifier Integration</a> - Transformation rules</li>
<li><a href="../linting/security.html">Linter Integration</a> - Linting rules reference</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../getting-started/first-purification.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../concepts/purification.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../getting-started/first-purification.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../concepts/purification.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../editor.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
