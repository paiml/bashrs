# Introduction

Welcome to **The bashrs Programming Language** - a practical guide to writing deterministic, POSIX-compliant shell scripts using Rust syntax.

## Why bashrs?

Shell scripts are powerful but dangerous. They're everywhere in DevOps, CI/CD, and system administration, but they're notoriously hard to get right:

- **Quoting Hell**: One wrong quote and your script breaks or becomes vulnerable
- **Injection Attacks**: User input can easily escape and execute arbitrary commands
- **Non-determinism**: Same script produces different results on different runs
- **No Type Safety**: Everything is a string until runtime

bashrs solves these problems by:
1. Writing in a restricted Rust subset (type-safe, familiar)
2. Transpiling to POSIX shell (universally compatible)
3. Verifying correctness (ShellCheck, injection prevention)
4. Ensuring determinism (same input → same output, always)

## Who This Book Is For

This book is for:
- **DevOps Engineers** building bootstrap installers
- **SREs** writing deployment scripts
- **Systems Programmers** needing portable shell automation
- **Security Engineers** requiring verifiable script generation

You should have:
- Basic Rust knowledge (variables, functions, control flow)
- Familiarity with shell scripting (bash, sh)
- Understanding of POSIX compliance concepts

## How This Book Works

This book follows **EXTREME TDD** (Test-Driven Development):

### Every Chapter Has:
1. **Problem Statement**: What we're solving
2. **Test Cases**: Examples that must work
3. **Implementation**: How bashrs transpiles it
4. **Generated Shell**: Actual output with ShellCheck validation
5. **Edge Cases**: Known limitations and workarounds

### Status Indicators:
- ✅ **Working**: Feature fully implemented and tested
- ⚠️ **Partial**: Some cases work, some don't
- ❌ **Broken**: Known issues, needs fixing
- 📋 **Planned**: Future feature, not yet implemented

## Test-Driven Philosophy

Every code example in this book is:
1. **Tested**: Has a corresponding test in `tests/`
2. **Verified**: Passes ShellCheck POSIX validation
3. **Deterministic**: Same input produces same output
4. **Documented**: Edge cases and limitations clearly stated

When you see a code block like this:

```rust
// Example: hello.rs
#[bashrs::main]
fn main() {
    println!("Hello, World!");
}
```

It corresponds to a test file `tests/ch01-hello-shell/test_01_basic.rs` that:
- Transpiles the Rust to shell
- Runs ShellCheck validation
- Executes the generated script
- Verifies output matches expectations

## How to Read This Book

### Linear Reading (Recommended)
Start at Chapter 1 and work through sequentially. Each chapter builds on previous concepts.

### Reference Reading
Jump to specific chapters when you need to solve a particular problem. Use the appendices for quick API lookups.

### Hands-On Learning
Every chapter has runnable examples. Clone the repository and run:

```bash
git clone https://github.com/paiml/bashrs
cd bashrs
make test-book  # Run all book examples
make test-ch01  # Run Chapter 1 examples
```

## Project Structure

```
bashrs/
├── rash/           # Core transpiler
│   ├── src/
│   │   ├── services/   # Parser, IR generation
│   │   ├── emitter/    # Shell code generation
│   │   ├── verifier/   # Safety verification
│   │   └── ...
│   └── tests/      # Unit and integration tests
├── rash-book/      # This book
│   ├── src/        # Markdown chapters
│   └── tests/      # Test cases for examples
└── examples/       # Example bashrs programs
```

## Quality Metrics

Current bashrs quality (as of Sprint 9):
- **Test Suite**: 539 passing (100% pass rate)
- **Coverage**: 85.36% (core modules)
- **Complexity**: All core functions <10 (cognitive)
- **Property Tests**: 23 properties, ~13,300 test cases
- **ShellCheck**: 100% pass rate (24 validation tests)
- **Determinism**: 11 idempotence tests passing

## Conventions Used in This Book

### Code Blocks

**Rust input**:
```rust
// input.rs
fn main() { ... }
```

**Generated shell output**:
```sh
#!/bin/sh
# Generated by bashrs
...
```

**Terminal commands**:
```bash
$ bashrs build input.rs -o script.sh
$ shellcheck -s sh script.sh
```

### Information Boxes

> **Note**: Additional context or tips

> **Warning**: Common pitfalls or gotchas

> **Advanced**: Deep dive into implementation details

## Getting Help

- **Book Issues**: https://github.com/paiml/bashrs/issues
- **Examples**: https://github.com/paiml/bashrs/tree/main/examples
- **API Docs**: https://docs.rs/bashrs (coming soon)
- **Test Status**: See [Test Status Dashboard](test-status.md)

## Let's Begin!

Ready to write safe, deterministic shell scripts? Let's start with [Chapter 1: Hello Shell Script](ch01-hello-shell-tdd.md).
